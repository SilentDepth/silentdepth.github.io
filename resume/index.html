<!doctype html>
<html lang="zh-CN">
<meta chartset="utf-8">
<title>Huang Wei's Resume</title>

<link rel="stylesheet" href="style.css">

<div id="paper">
  <em class="guide">读取数据中，请根据提示输入密码</em>
</div>

<script>
  if (typeof Promise === 'undefined') {
    document.write('<script src="https://unpkg.com/promise-polyfill@6.0.2/promise.min.js"><\/script>');
  }
</script>
<script src="./xor.js"></script>
<script>
  Promise.all([
    new Promise(function (resolve) {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', './segment.enc.html');
      xhr.addEventListener('load', function () {
        resolve(this.responseText);
      });
      xhr.send();
    }),
    new Promise(function (resolve) {
      var salt = window.prompt('What is salt?');
      resolve(salt);
    })
  ]).then(function (results) {
    paper.innerHTML = xor(results[0], results[1]);
  }).then(function () {
    // Calc my age
    var ageSpanTmpl = '({{age}}岁)';
    var agePlaceholder = '{{age}}';
    var age = (new Date()).getFullYear() - 1989;
    document.querySelector('#age').innerText = ageSpanTmpl.replace(agePlaceholder, age);
  });
</script>

</html>